import DocsLayout from '../../../layouts/DocsLayout';
import { Image } from 'theme-ui';

<DocsLayout>

# Design Considerations

### On-chain order book and a matching engine

The Oasis protocol uses an on-chain order book and a matching engine. The main advantage of having the mechanism designed in this manner is that liquidity is available for other smart contracts to access it in one atomic Ethereum transaction. 

### Partial decentralization

It's important to note that the protocol isn't completely decentralized yet, in that, the owner of the market has control over three administrative functions:

1. Setting **dust** limits (`setMinSell()`)  to ensure that every trade is cost-effective in terms of gas costs
2. Closing the market (`stop()`) 
3. Disabling the matching engine (`setMatchingEnabled(bool matchingEnabled_)`) 

However, the team has been working on a new version of the contract which will remove the above issues, thereby making the protocol fully decentralized.

### Escrow model for instant settlement

An order book for each market is implemented as two double-linked sorted lists, one list for each side of the market (buy and sell). At any point in time, the lists should be sorted accordingly. 

**Use of an Escrow model for Makers**. The Escrow model simply intends that a given asset is locked within the contract when a new order is placed - Makers cannot access their funds until their order is settled or canceled.  Although such an approach locks down the liquidity, it guarantees instantaneous risk-free settlement. 

### Important Notes

- It is important to mention that as a user interacting with the Oasis Protocol or as a user trading on OasisDex or Oasis Instant, that you can only sell and buy **ETH**. You cannot sell or buy DAI.
- **Dust** refers to tiny asset quantities that the gas cost of making/taking an offer is higher than the amount being traded for. With oasis, the contracts matching engine **automatically cancels** a resting order by checking if the remaining asset quantities of the partially filled remaining resting order is smaller then the defined dust limit.
- **Re-entrancy attacks -** The transfer of ERC-20 tokens from one participant to another requires calling into ERC-20 token contracts, and therefore comes with the risk of a [re-entry attack.](https://medium.com/@gus_tavo_guim/reentrancy-attack-on-smart-contracts-how-to-identify-the-exploitable-and-an-example-of-an-attack-4470a2d8dfe4) The `simple_market` contract guards three main functions: `offer()`, `buy()`and `cancel()`against it using `synchronized` modifier.


</DocsLayout>
